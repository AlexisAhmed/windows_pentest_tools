'Any2Bat.vbs v2.0 by zzzEVAzzz
Set fso = CreateObject("Scripting.FileSystemObject")
Set shl = CreateObject("WScript.Shell")
Set xml = CreateObject("Microsoft.XMLDOM")
Set stm = CreateObject("ADODB.Stream")
Set arg = WScript.Arguments
If arg.Count = 0 Then WScript.Quit
If Not fso.FileExists(arg(0)) Then WScript.Quit
Set f = fso.GetFile(arg(0))
rr = shl.Run("makecab.exe """ & f.Path & """ xx.cab", 0, True)
If rr <> 0 Then WScript.Quit
Set el = xml.createElement("cab")
el.dataType = "bin.base64"
stm.Open : stm.Type = 1
stm.LoadFromFile "xx.cab"
el.nodeTypedValue = stm.Read
txt = Replace(el.text, vbLf, ">>xx" & vbNewLine & "@echo ")
stm.Close
fso.DeleteFile "xx.cab"
With fso.OpenTextFile(f.Path & ".bat", 2, True)
.WriteLine "@echo ^<package^>^<cab xmlns:dt=""urn:schemas-microsoft-com:datatypes"" dt:dt=""bin.base64""^> >xx"
.Write "@echo " : .Write txt : .WriteLine ">>xx"
.WriteLine "@echo ^</cab^>^<job^>^<script language=""VBScript""^> >>xx"
.WriteLine "@echo Set xml = CreateObject(""Microsoft.XMLDOM"")>>xx"
.WriteLine "@echo xml.load WScript.ScriptFullName>>xx"
.WriteLine "@echo Set stm = CreateObject(""ADODB.Stream"")>>xx"
.WriteLine "@echo stm.Open : stm.Type = 1 >>xx"
.WriteLine "@echo stm.Write xml.documentElement.childNodes.item(0).nodeTypedValue>>xx"
.WriteLine "@echo stm.SaveToFile ""xx.cab"">>xx"
.WriteLine "@echo ^</script^>^</job^>^</package^> >>xx"
.WriteLine "rename xx xx.wsf"
.WriteLine "cscript.exe //nologo xx.wsf"
.WriteLine "expand.exe -r xx.cab>nul"
.Write "del xx.wsf & del xx.cab"
.Close
End With