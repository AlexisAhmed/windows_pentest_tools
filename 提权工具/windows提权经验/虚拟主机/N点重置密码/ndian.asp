<!--#include file="../inc/conn.asp" -->
<!--#include file="../inc/char.asp" -->
<!--#include file="../inc/npoint.asp" -->
<%
Function RandStr(LenNum) '生成随机数函数
On Error Resume Next
    Dim K, tmp
    For K = 1 To LenNum
        Randomize
        If K = 1 Or K = 4 Then
            tmp = tmp & Mid("ABCDEFGHIJKLMNOPQRSTUVWXYZ", Fix(Rnd * 26) + 1, 1)
        ElseIf K = 2 Or K = 5 Then
            tmp = tmp & Mid("123456789", Fix(Rnd * 9) + 1, 1)
        ElseIf K = 3 Or K = 6 Then
            tmp = tmp & Mid("abcdefghijklmnopqrstuvwxyz", Fix(Rnd * 26) + 1, 1)
        Else
            tmp = tmp & Mid("123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz", Fix(Rnd * 61) + 1, 1)
        End If
    Next
    RandStr = tmp
End Function
temp = RandStr(8)
response.write("管理员密码已成功重置为："&temp&"，请去后台手动修改密码！")
sql="Update adminlogo Set pass='"&npoint(temp)&"' Where name='admin'"
conn.Execute(sql)
%>