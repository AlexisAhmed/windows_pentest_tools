Microsoft Windows xxxCreateWindowEx()函数创建窗口本地权限提升漏洞（MS10-048）
发布日期：2010-08-10
更新日期：2010-08-11

受影响系统：
Microsoft Windows XP SP3
Microsoft Windows XP Pro x64版SP2
Microsoft Windows Vista SP2
Microsoft Windows Vista SP1
Microsoft Windows Server 2008 SP2
Microsoft Windows Server 2008 R2
Microsoft Windows Server 2008
Microsoft Windows Server 2003 SP2
Microsoft Windows 7
描述：



BUGTRAQ  ID: 42206
CVE ID: CVE-2010-1897

Microsoft Windows是微软发布的非常流行的操作系统。

Windows中的win32k.sys内核驱动中的xxxCreateWindowEx函数在处理某些回调参数时存在内核级权限提升漏洞。在正常情况下从用户空间调用CreateWindow时，会执行NtUserCreateWindowEx内核函数，xxxCreateWindowEx位于内核端调用栈上的临近位置。之后的函数会检查回调函数（或钩子）并调用xxxCallHook将注册的回调函数分发到用户空间。

用于将参数传送回创建窗口的进程的机制存在漏洞。这些参数通过栈传送到了用户空间，并在执行了回调函数后被内核重用。如果回调函数将hParent参数重置为类似于0xffffffff或0xfffffffe的伪句柄值，内核就会崩溃。

成功利用这个漏洞的攻击者可以执行任意内核态代码。攻击者可随后安装程序；查看、更改或删除数据；或者创建拥有完全用户权限的新帐户。

