Microsoft Windows SMB驱动本地权限提升漏洞（MS06-030）

发布日期：2006-06-13
更新日期：2006-06-14

受影响系统：
Microsoft Windows XP SP2
Microsoft Windows XP SP1
Microsoft Windows Server 2003 SP1
Microsoft Windows Server 2003
Microsoft Windows 2000
描述：
--------------------------------------------------------------------------------
BUGTRAQ  ID: 18356
CVE(CAN) ID: CVE-2006-2373

Microsoft Windows是微软发布的非常流行的操作系统。

Microsoft客户端缓存（CSCDLL.DLL）和Microsoft服务器消息块重新定向器驱动（MRXSMB.SYS）代码中存在漏洞，本地攻击者可能利用此漏洞提升权限获取机器的完全控制。

用户态程序可通过IOCTL命令访问MRXSMB.SYS的功能函数。在MrxSmbCscIoctlOpenForCopyChunk()函数中存在访问验证错误。如果要同MRXSMB子系统建立通讯的话，就必须创建到影子设备的文件句柄，并使用DeviceIoControl()发布命令。如果攻击者使用METHOD_NEITHER方式标记的话，可能导致不检查地址覆盖Kernel内存，执行攻击者指定的ring0指令。

